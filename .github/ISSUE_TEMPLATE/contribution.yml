name: ðŸŽ¯ Query Contribution
description: Submit a new XQL query, BIOC rule, or correlation rule to XQL Hub
title: "[Contribution] "
labels: ["contribution", "status: pending-review"]
body:
  - type: markdown
    attributes:
      value: |
        ## Thanks for contributing to XQL Hub! ðŸŽ‰
        
        Please paste the YAML generated by the [contribution wizard](https://xql-hub.com/contribute) below.
        
        **Note:** If you haven't used the wizard, please ensure your YAML follows our [schema documentation](https://github.com/intrusus-dev/xql-hub/blob/main/CONTRIBUTING.md#query-schema).

  - type: dropdown
    id: content-type
    attributes:
      label: Content Type
      description: What type of content are you submitting?
      options:
        - Threat Hunting Query
        - BIOC Rule
        - Correlation Rule
        - IT Hygiene Query
        - Dashboard Widget
    validations:
      required: true

  - type: textarea
    id: yaml-content
    attributes:
      label: Query YAML
      description: Paste the generated YAML content here
      render: yaml
      placeholder: |
        name: "Your Query Name"
        author: "your-name"
        description: "What this query detects..."
        content_type: hunting
        severity: "Medium"
        mitre_ids:
          - "T1059.001"
        log_sources:
          - "Cortex XDR Agent"
        tags:
          - "PowerShell"
        query: |
          dataset = xdr_data
          | filter ...
    validations:
      required: true

  - type: textarea
    id: testing-notes
    attributes:
      label: Testing Notes
      description: How did you test this query? Any false positive rates observed?
      placeholder: |
        - Tested in environment with X endpoints
        - Ran for Y days
        - False positive rate: ~Z%
        - Known limitations: ...

  - type: checkboxes
    id: checklist
    attributes:
      label: Submission Checklist
      description: Please confirm the following
      options:
        - label: I have tested this query in my environment
          required: true
        - label: The query does not contain sensitive or environment-specific data (IP addresses, hostnames, etc.)
          required: true
        - label: MITRE ATT&CK mappings are accurate
          required: true
        - label: I have read and agree to the [Code of Conduct](https://github.com/intrusus-dev/xql-hub/blob/main/CODE_OF_CONDUCT.md)
          required: true

  - type: textarea
    id: additional-context
    attributes:
      label: Additional Context
      description: Any additional information, references, or related queries
      placeholder: |
        - Related to CVE-XXXX-XXXX
        - Based on technique documented at ...
        - Inspired by query from ...